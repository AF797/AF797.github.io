<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>내 짝은 어디에?</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column
    }
    canvas {
        position: absolute;
        top: 0;
        left: 0;
    }
    #map {
      width: 500px;
      height: 400px;
    }
  </style>
</head>
<body>
  <h1>내 짝은 어디에?</h1>
  <div>
    <label for="name">이름:</label>
    <input type="text" id="name" placeholder="홍길동">
    <br>
    <label for="age">나이:</label>
    <input type="text" id="age" placeholder="24">
    <br>
    <label for="region">지역:</label>
    <input type="text" id="region" placeholder="구미시">
    <button onclick="input_text()">Search</button>
    <br><br>
  </div>
  <div id="map"></div>
  <br>
  <button onclick="input_text()">Search</button>

  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=1bb19c8f6495a5506c11c093b737801c&libraries=services"></script>
  <script>
    const API_KEY = '1bb19c8f6495a5506c11c093b737801c';
    
    // 카카오 맵 초기화
    const initializeMap = () => {
      if (map) {
        return map; // 이미 초기화된 맵이 있을 경우, 기존의 맵 객체 반환
      }
        const container = document.getElementById('map');
        const options = {
        center: new kakao.maps.LatLng(37.5665, 126.9780),
        level: 12
        };
        map = new kakao.maps.Map(container, options);
        return map;
    };
    
    // 랜덤한 위치에 핀을 두는 함수
    const placeRandomPin = () => {
        const map = initializeMap();
        // 기존 마커들 제거
        removeMarkers();
        const position = new kakao.maps.LatLng(Math.random() * (43.0 - 33.0) + 33.0, Math.random() * (132.0 - 124.0) + 124.0);
        const marker = new kakao.maps.Marker({ position });
        marker.setMap(map);
        markers.push(marker);
        map.setCenter(position);
    };
    
    let map; // 전역 변수로 맵 객체 선언
    let markers = []; // 마커들을 저장할 배열
    const input_text = () => {
      const name = document.getElementById('name').value;
      const age = document.getElementById('age').value;
      const region = document.getElementById('region').value;

      if (name != '' && age != '' && region != '')
      {
        placeRandomPin();
      }
    };
    
    const removeMarkers = () => {
      for (let i = 0; i < markers.length; i++) {
        markers[i].setMap(null); // 맵에서 마커 제거
      }
      markers = []; // 마커 배열 비우기
    };
    
    // 페이지 로드 시 카카오 맵 초기화
    window.onload = initializeMap;
  
  </script>
</body>
</html>
